{"remainingRequest":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuzhongliang/Documents/learnWebpack/mall/src/views/detail/detail.vue?vue&type=style&index=0&id=ff20c6b6&scoped=true&lang=css&","dependencies":[{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/src/views/detail/detail.vue","mtime":1599715224451},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.detail-scroll {\n  height: calc(100vh - 102px);\n  overflow: hidden;\n}\n.clear {\n  clear:both;\n  margin-top: 55px;\n}\n",{"version":3,"sources":["detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\n  <div>\n    <detail-nav-bar @navClick= \"navClick\" ref=\"nav\"></detail-nav-bar>\n    <div class=\"clear\"></div>\n    <scroll class=\"detail-scroll\" ref=\"detailScroll\" :probeType= \"3\" @scroll= \"detailScroll\" :pull-up-load='true'>\n      <detail-swiper :detailBanner=\"detailbanner\"></detail-swiper>\n      <detail-base-info :goods= \"goods\"></detail-base-info>\n      <detail-shop-info :shop= \"shop\"></detail-shop-info>\n      <detail-img :detailDes=\"detailImg\" @imgLoad=\"imgLoad\"></detail-img>\n      <detail-params :itemParams= \"itemParams\" :ruleParams= \"ruleParams\" :paramsImg= \"paramsImg\" ref= \"params\"></detail-params>\n      <detail-comment :rate= \"comment\" ref=\"comment\"></detail-comment>\n      <goods-view :goods= \"recommend\" ref=\"recommend\"></goods-view>\n    </scroll>\n    <detail-bottom-bar></detail-bottom-bar>\n    <backtop @back-click='backClick' v-show='isShow'></backtop>\n  </div>\n</template>\n\n<script>\nimport { getDetails, getRecommend, Goods, Shop } from '@/network/detail'\nimport { debounce } from '@/network/util'\nimport { backTopMixin } from '@/network/mixin'\nimport detailNavBar from './detailComps/detailNavBar'\nimport detailSwiper from './detailComps/detailSwiper'\nimport detailBaseInfo from './detailComps/detailBaseInfo'\nimport detailShopInfo from './detailComps/detailShopInfo'\nimport detailParams from './detailComps/detailParams'\nimport detailImg from './detailComps/detailImg'\nimport detailComment from './detailComps/detailComment'\nimport detailBottomBar from './detailComps/detailBottomBar'\nimport scroll from 'components/common/BScroll/BScroll'\nimport goodsView from 'components/common/goods/goodsView'\nexport default {\n  name: 'detail',\n  data () {\n    return {\n      iid: null,\n      detailbanner: [],\n      goods: {},\n      shop: {},\n      detailImg: {},\n      itemParams: [],\n      ruleParams: [],\n      paramsImg: null,\n      comment: {},\n      recommend: [],\n      paramsY: [],\n      getParamsY: null,\n      currentIndex: 0\n    }\n  },\n  mixins: [backTopMixin],\n  components: {\n    detailNavBar,\n    detailSwiper,\n    detailBaseInfo,\n    detailShopInfo,\n    detailParams,\n    detailImg,\n    detailComment,\n    detailBottomBar,\n    scroll,\n    goodsView\n  },\n  created () {\n    this.iid = this.$route.params.iid\n    getDetails(this.iid).then(res => {\n      console.log(res)\n      const data = res.result\n      // 获取详情banner\n      this.detailbanner = data.itemInfo.topImages\n      // 获取商品基本信息\n      this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services)\n      // 获取店铺信息\n      this.shop = new Shop(data.shopInfo)\n      //  获取描述图片\n      this.detailImg = data.detailInfo\n      // 获取参数信息\n      this.itemParams = data.itemParams.info.set\n      this.ruleParams = data.itemParams.rule.tables\n      this.paramsImg = data.itemParams.info.images ? data.itemParams.info.images[0] : ''\n      // 获取用户评论信息\n      this.comment = data.rate\n    })\n    getRecommend().then(res => {\n      console.log(res)\n      this.recommend = res.data.list\n    })\n    this.getParamsY = debounce(() => {\n      this.paramsY = []\n      this.paramsY.push('0')\n      this.paramsY.push(this.$refs.params.$el.offsetTop)\n      this.paramsY.push(this.$refs.comment.$el.offsetTop)\n      this.paramsY.push(this.$refs.recommend.$el.offsetTop)\n      console.log(this.paramsY)\n    })\n  },\n  mounted () {\n    // 监听图片是否加载完成\n    // 对于下面这部分的代码也可以用混入，封装一个mixin.js文件\n    const refresh = debounce(this.$refs.detailScroll.refresh)\n    this.$bus.$on('imgLoad', () => {\n      refresh()\n    })\n  },\n  methods: {\n    imgLoad () {\n      this.$refs.detailScroll.refresh()\n      this.getParamsY()\n    },\n    navClick (index) {\n      this.$refs.detailScroll.scrollTo(0, -(this.paramsY[index] - 50), 200)\n    },\n    detailScroll (position) {\n      // 获取当前y的值\n      const positionY = -position.y\n      const ylength = this.paramsY.length\n      // 空间换时间\n      // 判断语句，还可以不用后面那部分，即在数组中最后再插入一个最大值，number.maxValue,即无需后面那部分的判断，把循环语句改为i<ylength - 1\n      for (let i = 0; i < ylength; i++) {\n        if (this.currentIndex !== i && ((i < ylength - 1 && positionY >= this.paramsY[i] && positionY < this.paramsY[i + 1]) || (i === ylength - 1 && positionY >= this.paramsY[i]))) {\n          this.currentIndex = i\n          this.$refs.nav.currentIndex = this.currentIndex\n        }\n      }\n      // 判断backtop是否显示\n      this.isShow = -(position.y) > 200\n    }\n  }\n}\n</script>\n\n<style scoped>\n.detail-scroll {\n  height: calc(100vh - 102px);\n  overflow: hidden;\n}\n.clear {\n  clear:both;\n  margin-top: 55px;\n}\n</style>\n"]}]}