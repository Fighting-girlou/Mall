{"remainingRequest":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/babel-loader/lib/index.js!/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuzhongliang/Documents/learnWebpack/mall/src/views/detail/detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/src/views/detail/detail.vue","mtime":1599827514868},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuzhongliang/Documents/learnWebpack/mall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getDetails, getRecommend, Goods, Shop } from '@/network/detail';\nimport { debounce } from '@/network/util';\nimport { backTopMixin } from '@/network/mixin';\nimport detailNavBar from \"./detailComps/detailNavBar\";\nimport detailSwiper from \"./detailComps/detailSwiper\";\nimport detailBaseInfo from \"./detailComps/detailBaseInfo\";\nimport detailShopInfo from \"./detailComps/detailShopInfo\";\nimport detailParams from \"./detailComps/detailParams\";\nimport detailImg from \"./detailComps/detailImg\";\nimport detailComment from \"./detailComps/detailComment\";\nimport detailBottomBar from \"./detailComps/detailBottomBar\";\nimport scroll from 'components/common/BScroll/BScroll';\nimport goodsView from 'components/common/goods/goodsView';\nexport default {\n  name: 'detail',\n  data: function data() {\n    return {\n      iid: null,\n      detailbanner: [],\n      goods: {},\n      shop: {},\n      detailImg: {},\n      itemParams: [],\n      ruleParams: [],\n      paramsImg: null,\n      comment: {},\n      recommend: [],\n      paramsY: [],\n      getParamsY: null,\n      currentIndex: 0\n    };\n  },\n  mixins: [backTopMixin],\n  components: {\n    detailNavBar: detailNavBar,\n    detailSwiper: detailSwiper,\n    detailBaseInfo: detailBaseInfo,\n    detailShopInfo: detailShopInfo,\n    detailParams: detailParams,\n    detailImg: detailImg,\n    detailComment: detailComment,\n    detailBottomBar: detailBottomBar,\n    scroll: scroll,\n    goodsView: goodsView\n  },\n  created: function created() {\n    var _this = this;\n\n    this.iid = this.$route.params.iid;\n    getDetails(this.iid).then(function (res) {\n      console.log(res);\n      var data = res.result; // 获取详情banner\n\n      _this.detailbanner = data.itemInfo.topImages; // 获取商品基本信息\n\n      _this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services); // 获取店铺信息\n\n      _this.shop = new Shop(data.shopInfo); //  获取描述图片\n\n      _this.detailImg = data.detailInfo; // 获取参数信息\n\n      _this.itemParams = data.itemParams.info.set;\n      _this.ruleParams = data.itemParams.rule.tables;\n      _this.paramsImg = data.itemParams.info.images ? data.itemParams.info.images[0] : ''; // 获取用户评论信息\n\n      _this.comment = data.rate;\n      console.log(_this.goods);\n    });\n    getRecommend().then(function (res) {\n      console.log(res);\n      _this.recommend = res.data.list;\n    });\n    this.getParamsY = debounce(function () {\n      _this.paramsY = [];\n\n      _this.paramsY.push('0');\n\n      _this.paramsY.push(_this.$refs.params.$el.offsetTop);\n\n      _this.paramsY.push(_this.$refs.comment.$el.offsetTop);\n\n      _this.paramsY.push(_this.$refs.recommend.$el.offsetTop);\n\n      console.log(_this.paramsY);\n    }, 500);\n  },\n  mounted: function mounted() {\n    // 监听图片是否加载完成\n    // 对于下面这部分的代码也可以用混入，封装一个mixin.js文件\n    var refresh = debounce(this.$refs.scroll.refresh);\n    this.$bus.$on('imgLoad', function () {\n      refresh();\n    });\n  },\n  methods: {\n    imgLoad: function imgLoad() {\n      this.$refs.scroll.refresh();\n      this.getParamsY();\n    },\n    navClick: function navClick(index) {\n      this.$refs.scroll.scrollTo(0, -(this.paramsY[index] - 50), 200);\n    },\n    detailScroll: function detailScroll(position) {\n      // 获取当前y的值\n      var positionY = -position.y;\n      var ylength = this.paramsY.length; // 空间换时间\n      // 判断语句，还可以不用后面那部分，即在数组中最后再插入一个最大值，number.maxValue,即无需后面那部分的判断，把循环语句改为i<ylength - 1\n\n      for (var i = 0; i < ylength; i++) {\n        if (this.currentIndex !== i && (i < ylength - 1 && positionY >= this.paramsY[i] && positionY < this.paramsY[i + 1] || i === ylength - 1 && positionY >= this.paramsY[i])) {\n          this.currentIndex = i;\n          this.$refs.nav.currentIndex = this.currentIndex;\n        }\n      } // 判断backtop是否显示\n\n\n      this.isShow = -position.y > 200;\n    },\n    cartClick: function cartClick() {\n      var _this2 = this;\n\n      var product = {};\n      product.img = this.detailbanner[0];\n      product.title = this.goods.title;\n      product.desc = this.goods.desc;\n      product.price = this.goods.realprice;\n      product.iid = this.iid; // 把商品添加到store中\n\n      this.$store.dispatch('addCart', product).then(function (res) {\n        _this2.$toast.show(res, 2000);\n\n        console.log(_this2.$toast);\n      });\n    }\n  }\n};",{"version":3,"sources":["detail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <detail-nav-bar @navClick= \"navClick\" ref=\"nav\"></detail-nav-bar>\n    <div class=\"clear\"></div>\n    <scroll class=\"detail-scroll\" ref=\"scroll\" :probeType= \"3\" :pull-up-load='true'>\n      <detail-swiper :detailBanner=\"detailbanner\"></detail-swiper>\n      <detail-base-info :goods= \"goods\"></detail-base-info>\n      <detail-shop-info :shop= \"shop\"></detail-shop-info>\n      <detail-img :detailDes=\"detailImg\" @imgLoad=\"imgLoad\"></detail-img>\n      <detail-params :itemParams= \"itemParams\" :ruleParams= \"ruleParams\" :paramsImg= \"paramsImg\" ref= \"params\"></detail-params>\n      <detail-comment :rate= \"comment\" ref=\"comment\"></detail-comment>\n      <goods-view :goods= \"recommend\" ref=\"recommend\"></goods-view>\n    </scroll>\n    <detail-bottom-bar @cartClick =\"cartClick\"></detail-bottom-bar>\n    <backtop @back-click='backClick' v-show='isShow'></backtop>\n  </div>\n</template>\n\n<script>\nimport { getDetails, getRecommend, Goods, Shop } from '@/network/detail'\nimport { debounce } from '@/network/util'\nimport { backTopMixin } from '@/network/mixin'\n\nimport detailNavBar from './detailComps/detailNavBar'\nimport detailSwiper from './detailComps/detailSwiper'\nimport detailBaseInfo from './detailComps/detailBaseInfo'\nimport detailShopInfo from './detailComps/detailShopInfo'\nimport detailParams from './detailComps/detailParams'\nimport detailImg from './detailComps/detailImg'\nimport detailComment from './detailComps/detailComment'\nimport detailBottomBar from './detailComps/detailBottomBar'\n\nimport scroll from 'components/common/BScroll/BScroll'\nimport goodsView from 'components/common/goods/goodsView'\n\nexport default {\n  name: 'detail',\n  data () {\n    return {\n      iid: null,\n      detailbanner: [],\n      goods: {},\n      shop: {},\n      detailImg: {},\n      itemParams: [],\n      ruleParams: [],\n      paramsImg: null,\n      comment: {},\n      recommend: [],\n      paramsY: [],\n      getParamsY: null,\n      currentIndex: 0\n    }\n  },\n  mixins: [backTopMixin],\n  components: {\n    detailNavBar,\n    detailSwiper,\n    detailBaseInfo,\n    detailShopInfo,\n    detailParams,\n    detailImg,\n    detailComment,\n    detailBottomBar,\n    scroll,\n    goodsView\n  },\n  created () {\n    this.iid = this.$route.params.iid\n    getDetails(this.iid).then(res => {\n      console.log(res)\n      const data = res.result\n      // 获取详情banner\n      this.detailbanner = data.itemInfo.topImages\n      // 获取商品基本信息\n      this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services)\n      // 获取店铺信息\n      this.shop = new Shop(data.shopInfo)\n      //  获取描述图片\n      this.detailImg = data.detailInfo\n      // 获取参数信息\n      this.itemParams = data.itemParams.info.set\n      this.ruleParams = data.itemParams.rule.tables\n      this.paramsImg = data.itemParams.info.images ? data.itemParams.info.images[0] : ''\n      // 获取用户评论信息\n      this.comment = data.rate\n      console.log(this.goods)\n    })\n    getRecommend().then(res => {\n      console.log(res)\n      this.recommend = res.data.list\n    })\n    this.getParamsY = debounce(() => {\n      this.paramsY = []\n      this.paramsY.push('0')\n      this.paramsY.push(this.$refs.params.$el.offsetTop)\n      this.paramsY.push(this.$refs.comment.$el.offsetTop)\n      this.paramsY.push(this.$refs.recommend.$el.offsetTop)\n      console.log(this.paramsY)\n    }, 500)\n  },\n  mounted () {\n    // 监听图片是否加载完成\n    // 对于下面这部分的代码也可以用混入，封装一个mixin.js文件\n    const refresh = debounce(this.$refs.scroll.refresh)\n    this.$bus.$on('imgLoad', () => {\n      refresh()\n    })\n  },\n  methods: {\n    imgLoad () {\n      this.$refs.scroll.refresh()\n      this.getParamsY()\n    },\n    navClick (index) {\n      this.$refs.scroll.scrollTo(0, -(this.paramsY[index] - 50), 200)\n    },\n    detailScroll (position) {\n      // 获取当前y的值\n      const positionY = -position.y\n      const ylength = this.paramsY.length\n      // 空间换时间\n      // 判断语句，还可以不用后面那部分，即在数组中最后再插入一个最大值，number.maxValue,即无需后面那部分的判断，把循环语句改为i<ylength - 1\n      for (let i = 0; i < ylength; i++) {\n        if (this.currentIndex !== i && ((i < ylength - 1 && positionY >= this.paramsY[i] && positionY < this.paramsY[i + 1]) || (i === ylength - 1 && positionY >= this.paramsY[i]))) {\n          this.currentIndex = i\n          this.$refs.nav.currentIndex = this.currentIndex\n        }\n      }\n      // 判断backtop是否显示\n      this.isShow = -(position.y) > 200\n    },\n    cartClick () {\n      const product = {}\n      product.img = this.detailbanner[0]\n      product.title = this.goods.title\n      product.desc = this.goods.desc\n      product.price = this.goods.realprice\n      product.iid = this.iid\n      // 把商品添加到store中\n      this.$store.dispatch('addCart', product).then(res => {\n        this.$toast.show(res, 2000)\n        console.log(this.$toast)\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.detail-scroll {\n  height: calc(100vh - 102px);\n  overflow: hidden;\n}\n.clear {\n  clear:both;\n  margin-top: 55px;\n}\n</style>\n"],"sourceRoot":"src/views/detail"}]}